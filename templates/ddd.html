<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>统计文件获取</title>
</head>
<!DOCTYPE html>

<body>


<br>
输入网址:<br><br>
<input class="input-box" type="text">
<br><br>
<input id="w" type="button" value="提交" onclick="getInputVal()">
<br><br>
<p>状态:</p>
<br><br>
<input type="button" onclick="download()" value="点我下载文件">


<p class="content"></p>
<script src="/static/jquery-3.3.1.js"></script>
<script>
		function getInputVal(){
			const inputBox = document.querySelectorAll('.input-box')[0],
				  content = document.querySelectorAll('.content')[0],
                  a= document.querySelectorAll('a')[0];
			// 获取input输入框中的值

			let inputVal = inputBox.value;
            let url = inputBox.value;
			if(inputVal){
				content.innerHTML = inputVal;


                schedule({"project":"Statistics","spider":"statistic","url":inputVal});

			}else{
				alert('请在input输入框中填点东西');
			}
		}
		function download(){

		    const content = document.querySelectorAll('.content')[0],
		          inputBox = document.querySelectorAll('.input-box')[0];
			// 获取input输入框中的值

			let inputVal = inputBox.value;
            if(inputVal){
                var reg1=/productId=(\d+)/;
                var reg2=/(\d+)\.html/;
                var result = inputVal.match(reg1);
                if(result[0]){
                    var res = result[0].split("=")[1]
                }else{
                    var result = inputVal.match(reg2);
                    var res = result[0].split(".")[0]
                }

				content.innerHTML = res;
		        <!--window.open('http://124.173.70.94/files/'+result+'.zip');-->

			}else{
				alert('请在input输入框中填点东西');
			}
		}
		function schedule(param){
                if(!param || !param.project || !param.spider){
                    return daemonstatus();
                }

                <!--$.ajax({-->
                    <!--url: "http://124.173.70.94:6800/schedule.json",-->
                    <!--type:"POST",-->
                    <!--data:param,-->
                    <!--success: function(response){-->
                        <!--console.log(response)-->
                        <!--//if(callback)callback(response,param,tempData);-->
                    <!--},-->
                    <!--error: function(err){-->
                        <!--console.log(err)-->
                        <!--//if(failure)failure(err);-->
                    <!--},-->
                <!--});-->
            }
	</script>
</body>
</html>
